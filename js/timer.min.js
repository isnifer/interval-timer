!function(){function e(e){this.name=e.name||"Press",this.program=e.program?e.program:{},this.constructor=constructor?constructor:e.constructor,this.date=function(){if(e.date)return e.date;var t=new Date,r=["01","02","03","04","05","06","07","08","09","10","11","12"];return t.getDate()+"."+r[t.getMonth()]+"."+t.getFullYear()}()}function t(){var e=this.getAttribute("id");e=e.substring(e.indexOf("_")+1),v[e].load()}function r(){var e=this.id.substring(this.id.indexOf("_")+1);v[e].load(),d.reset.setAttribute("id","reset-timer_"+e),d.start.setAttribute("id","start-timer_"+e)}function n(e,t){var n=document.createElement("li"),a=document.createElement("span");n.classList.add("timers__item"),n.setAttribute("id","timer_"+e),a.classList.add("timers__name"),a.textContent=t,n.appendChild(a),p.appendChild(n),n.addEventListener("click",r,!1)}var a=document.querySelector(".controls__create"),o=document.querySelector(".partials__save"),i=(document.querySelector(".partials__reset"),document.querySelector(".partials__view")),c=document.querySelector(".partials__local"),s=(document.querySelector(".controls__form"),document.querySelector(".partials")),l=document.querySelector(".partials__content"),u=document.querySelector(".partials__add"),m=document.querySelector(".controls__name-block"),p=document.querySelector(".timers__list"),d=(document.getElementsByClassName("timers__item"),{el:document.querySelector(".current"),header:document.querySelector(".current__header"),actionTitle:document.querySelector(".current__action-title"),time:document.querySelector(".current__time"),elapsed:document.querySelector(".current__elapsed-time"),remaining:document.querySelector(".current__remaining-time"),circle:document.querySelector(".current__circles-this"),circles:document.querySelector(".current__circles-all"),start:document.querySelector(".current__start"),pause:document.querySelector(".current__pause"),reset:document.querySelector(".current__reset")}),g=1,_=1,v=[];e.prototype.createLocalTimer=function(t){return new e({name:t.name,program:t.program,constructor:e})},e.prototype.add=function(){var e=function(e){for(var t=document.createElement(e.tag),r=0;r<e.classNames.length;r++)t.classList.add(e.classNames[r]);return e.name&&t.setAttribute("name",e.name+"_"+g),e.content&&(t.textContent=e.content),"work"===e.name?g++:_++,t},t=function(t){var r=e({tag:"label",classNames:["partials__label"]}),n=e({tag:"span",classNames:["partials__name"],content:t+" (s)"}),a=e({tag:"input",classNames:["partials__input","partials__"+t],name:t});return r.appendChild(n),r.appendChild(a),r},r=t("work"),n=t("rest");l.appendChild(r),l.appendChild(n)},e.prototype.pushToDOM=function(e,t){n(t,e),i.setAttribute("id","view-timer_"+t),c.setAttribute("id","local-timer_"+t),d.reset.setAttribute("id","reset-timer_"+t),d.start.setAttribute("id","start-timer_"+t)},e.prototype.load=function(){var e=this;d.header.textContent=this.name,d.circles.textContent=this.program.circles,d.circle.textContent=1,d.actionTitle.textContent=this.program.workouts[0].title,d.time.textContent=function(){var t=e.program.workouts[0].value,r=function(){var e=t-60*parseInt(t/60);return 10>e?"0"+e:e}(),n=parseInt(t/60);return 3600>t&&t>=600?n+":"+r:600>t&&t>=60?"0"+n+":"+r:60>t&&t>10?"00:"+t:"00:0"+t}(),d.remaining.textContent=function(){var t=e.program.alltime,r=function(){var e=parseInt(t/60);return 10>e?"0"+e:e}(),n=function(){var e=t-60*parseInt(r);return 10>e?"0"+e:e}();return r+":"+n}()},e.prototype.start=function(e,t){var r=this,n=t?t:1,a=e?e:0,o=r.program.workouts,i=o[a].value;d.actionTitle.textContent=o[a].title;var c=setInterval(function(){d.time.textContent=function(){var e=function(){var e=parseInt(i/60);return 10>e?"0"+e:e}(),t=function(){var t=i-60*parseInt(e);return 10>t?"0"+t:t}();return e+":"+t}(),i-=1,0===i&&(clearInterval(c),o[a+1]?(console.log("Action change"),r.start(a+1,n)):n<r.program.circles?(console.log("Circle change"),r.changeCircle(n+1)):(console.log("Timer stop"),r.stop(c)))},1e3)},e.prototype.changeCircle=function(e){d.circle.textContent=e,this.start(0,e)},e.prototype.pause=function(){},e.prototype.reset=function(){},e.prototype.stop=function(e){e=null},e.prototype.changeElapsed=function(){var e=0,t=this,r=(t.program.alltime,setInterval(function(){var n=function(){var t=parseInt(e/60);return 10>t?"0"+t:t}(),a=function(){var t=e-60*parseInt(n);return 10>t?"0"+t:t}();d.elapsed.textContent=n+":"+a,e<t.program.alltime?e+=1:(clearInterval(r),r=null)},1e3))},e.prototype.changeRemaining=function(){var e=this,t=e.program.alltime,r=setInterval(function(){var e=function(){var e=parseInt(t/60);return 10>e?"0"+e:e}(),n=function(){var r=t-60*parseInt(e);return 10>r?"0"+r:r}();d.remaining.textContent=e+":"+n,0!==t?t-=1:(clearInterval(r),r=null)},1e3)},a.addEventListener("click",function(e){e.preventDefault(),m.classList.add("controls_hidden"),s.classList.add("partials_visible");var t=document.querySelector(".partials__timer-user-name");t.textContent=document.querySelector('input[name="timer-name"]').value},!1),o.addEventListener("click",function(){var t=new e({name:document.querySelector('input[name="timer-name"]').value});t.program={circles:parseInt(document.querySelector(".partials__circle").value),workouts:[],alltime:""};for(var r=document.getElementsByClassName("partials__work"),n=document.getElementsByClassName("partials__rest"),a=0;a<r.length;a++)t.program.workouts.push({title:"work",value:parseInt(r[a].value)}),t.program.workouts.push({title:"rest",value:parseInt(n[a].value)});t.program.alltime=function(){for(var e=t.program.workouts,r=e.length,n=0,a=0;r>a;a++)n+=e[a].value;return n*t.program.circles}(),v.push(t),console.log(v),t.pushToDOM(t.name,v.length-1),i.disabled=!1,c.disabled=!1},!1),u.addEventListener("click",function(t){t.preventDefault(),e.prototype.add()},!1),d.start.addEventListener("click",function(){var e=this.getAttribute("id");e=e.substring(e.indexOf("_")+1),v[e].start(),v[e].changeElapsed(),v[e].changeRemaining()},!1),i.addEventListener("click",t,!1),d.reset.addEventListener("click",t,!1),c.addEventListener("click",function(){var e=this.getAttribute("id");e=e.substring(e.indexOf("_")+1);var t,r={name:v[e].name,program:v[e].program},n=[];n.push(JSON.stringify(r)),localStorage.timers?(t=JSON.parse(localStorage.timers),t.push(JSON.stringify(r)),localStorage.setItem("timers",JSON.stringify(t)),console.log("Success Resave")):(localStorage.setItem("timers",JSON.stringify(n)),console.log("Success save")),console.log(localStorage.timers)},!1);!function(){if(localStorage.timers){var t=localStorage.timers,r=0;for(t=JSON.parse(t),r;r<t.length;r++){var a=JSON.parse(t[r]);v[v.length]=e.prototype.createLocalTimer({name:a.name,program:a.program}),n(v.length-1,a.name)}}}()}();